<div class="dashboard-container">
  <app-sidebar></app-sidebar>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Header -->
    <div class="dashboard-header">
      <h1>Welcome back, User!</h1>
      <div class="user-avatar">
        <img src="/assets/images/white_logo.png" alt="User Avatar" class="avatar-img">
      </div>
    </div>

    <!-- Products At Risk Section -->
    <div class="products-at-risk-section">
      <div class="section-header">
        <h2><i class="info-icon">‚Ñπ</i> Products At Risk</h2>
      </div>

      <div class="filters-row">
        <div class="search-box">
          <input type="text" placeholder="Search..." class="search-input">
          <i class="search-icon">üîç</i>
        </div>
        <select class="filter-select">
          <option>Warning Type</option>
          <option>Low Stock</option>
          <option>Expiry Risk</option>
          <option>Loss Risk</option>
        </select>
        <select class="filter-select">
          <option>Category</option>
          <option>Electronics</option>
          <option>Health</option>
          <option>Home</option>
        </select>
        <button class="refresh-btn">Refresh</button>
      </div>

      <div class="products-grid">
        <div *ngFor="let product of productsAtRisk"
             class="product-card"
             [ngClass]="product.warningLevel + '-card'">
          <div class="product-info">
            <h4>{{ product.name }}</h4>
            <p class="product-id">ID: <span>{{ product.id }}</span></p>
            <div class="product-image">
              <img [src]="product.image"
                   [alt]="product.name"
                   class="product-img"
                   [attr.data-fallback]="product.fallbackImage"
                   (error)="onImageError($event)">
            </div>
          </div>
          <div class="warning-section">
            <div class="warning-badge" [ngClass]="product.warningLevel">
              ‚ö†Ô∏è Warning: {{ product.warningType }}
            </div>
            <div class="notice">üìã Short Notice: {{ product.notice }}</div>
            <div class="suggestion">üí° Quick Suggestion: {{ product.suggestion }}</div>
          </div>
          <div class="card-actions">
            <button class="btn-confirm" (click)="confirmProduct(product.id)">Confirm</button>
            <button class="btn-edit" (click)="editProduct(product.id)">Edit Product</button>
          </div>
        </div>

        <div class="suggestions-panel">
          <h3>Reason Behind Suggestions</h3>
          <p>This product has been in stock for 17 days without sales compared to leading items, it's performing below average</p>

          <div class="mini-stats">
            <h4>Mini State Snapshot</h4>
            <p>This product has been in stock for 17 days without sales</p>
            <div class="stats-grid">
              <div class="stat-item">
                <span class="label">Last sale:</span>
                <span class="value">17 days ago</span>
              </div>
              <div class="stat-item">
                <span class="label">Remaining in stock:</span>
                <span class="value">24 units</span>
              </div>
              <div class="stat-item">
                <span class="label">Urgency level:</span>
                <span class="value high">High</span>
              </div>
              <div class="stat-item">
                <span class="label">Suggested Action Time:</span>
                <span class="value">Within 3 days</span>
              </div>
            </div>
          </div>

          <button class="btn-ai-help">
            <span>Need Any Help?</span>
            <div class="ai-icon">ü§ñ</div>
          </button>

          <button class="btn-ask-bot">Ask Our Bot</button>
        </div>
      </div>
    </div>

    <!-- Insight Panel Section -->
    <div class="insight-panel-section">
      <div class="section-header">
        <h2><i class="chart-icon">üìä</i> Insight Panel</h2>
      </div>

      <div class="insights-grid">
        <div class="insight-card loss-card">
          <div class="insight-header">
            <span class="indicator loss"></span>
            <span class="title">Loss</span>
            <span class="period">Weekly ‚ñº</span>
          </div>
          <div class="chart-container">
            <canvas class="mini-chart" data-chart="loss"></canvas>
          </div>
        </div>

        <div class="insight-card expired-card">
          <div class="insight-header">
            <span class="indicator expired"></span>
            <span class="title">Expired</span>
            <span class="period">Weekly ‚ñº</span>
          </div>
          <div class="chart-container">
            <canvas class="mini-chart" data-chart="expired"></canvas>
          </div>
        </div>

        <div class="insight-card low-sales-card">
          <div class="insight-header">
            <span class="indicator low-sales"></span>
            <span class="title">Low Sales</span>
            <span class="period">Weekly ‚ñº</span>
          </div>
          <div class="chart-container">
            <canvas class="mini-chart" data-chart="low-sales"></canvas>
          </div>
        </div>

        <div class="insight-card dead-stock-card">
          <div class="insight-header">
            <span class="indicator dead-stock"></span>
            <span class="title">Dead Stock</span>
            <span class="period">Weekly ‚ñº</span>
          </div>
          <div class="chart-container">
            <canvas class="mini-chart" data-chart="dead-stock"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Overall Performance Section -->
    <div class="performance-section">
      <div class="section-header">
        <h2><i class="performance-icon">üìà</i> Overall Performance</h2>
      </div>

      <div class="performance-chart-container">
        <div class="chart-legend">
          <div class="legend-item">
            <span class="legend-color value1"></span>
            <span>VALUE 1 (1)</span>
          </div>
          <div class="legend-item">
            <span class="legend-color value2"></span>
            <span>VALUE 2 (2)</span>
          </div>
        </div>
        <div class="main-chart-container">
          <canvas class="main-chart" data-chart="performance"></canvas>
        </div>
      </div>
    </div>

    <!-- Analytics Section -->
    <div class="analytics-section">
      <div class="analytics-grid">
        <!-- Warnings Donut Chart -->
        <div class="warnings-card">
          <h3>Warnings:</h3>
          <div class="donut-chart-container">
            <canvas class="donut-chart" data-chart="warnings"></canvas>
          </div>
          <div class="warnings-legend">
            <div class="warning-item">
              <span class="warning-color loss"></span>
              <span class="warning-label">Loss</span>
              <span class="warning-percentage">35%</span>
            </div>
            <div class="warning-item">
              <span class="warning-color almost-expired"></span>
              <span class="warning-label">Almost Expired</span>
              <span class="warning-percentage">35%</span>
            </div>
            <div class="warning-item">
              <span class="warning-color low-sales"></span>
              <span class="warning-label">Low Sales</span>
              <span class="warning-percentage">35%</span>
            </div>
            <div class="warning-item">
              <span class="warning-color dead-stock"></span>
              <span class="warning-label">Dead Stock</span>
              <span class="warning-percentage">35%</span>
            </div>
            <div class="warning-item">
              <span class="warning-color low-prices"></span>
              <span class="warning-label">Low Prices</span>
              <span class="warning-percentage">35%</span>
            </div>
          </div>
        </div>

        <!-- Profit Panel -->
        <div class="profit-panel">
          <div class="profit-tabs">
            <button class="tab-btn active" data-tab="profit">
              <i class="tab-icon">üí∞</i> Profit
            </button>
            <button class="tab-btn" data-tab="expiry">
              <i class="tab-icon">üìÖ</i> Expiry
            </button>
            <button class="tab-btn" data-tab="needs">
              <i class="tab-icon">üìã</i> Needs
            </button>
            <button class="tab-btn" data-tab="stock">
              <i class="tab-icon">üì¶</i> Stock
            </button>
          </div>

          <div class="profit-content">
            <div class="profit-header">
              <div class="profit-icon">üí∞</div>
              <h3>Average Profit</h3>
            </div>

            <p class="profit-description">
              Your average profit margin across all active products
            </p>

            <div class="profit-value">
              <span class="profit-sign">+</span>
              <span class="profit-number">12.5</span>
              <span class="profit-percent">%</span>
            </div>

            <div class="profit-comparison">
              <span>Compared to last month: </span>
              <span class="comparison-value positive">+3.2%</span>
            </div>

            <div class="profit-details">
              <div class="detail-item">
                <span class="detail-label">Best Performing Category:</span>
                <div class="detail-value">
                  <span>Snacks </span>
                  <span class="category-percentage">(+23%)</span>
                </div>
              </div>

              <div class="detail-item">
                <span class="detail-label">Worst Performing Category:</span>
                <div class="detail-value">
                  <span>Household </span>
                  <span class="category-percentage negative">(-7%)</span>
                </div>
              </div>

              <div class="detail-item">
                <span class="detail-label">Average Margin this week:</span>
                <div class="detail-value">
                  <span class="weekly-margin">+11.2%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>